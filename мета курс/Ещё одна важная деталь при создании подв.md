Ещё одна важная деталь при создании подвыборок — они должны обеспечить выбор элементов с возвращением. То есть один и тот же элемент может попадать в подвыборку несколько раз. Это достигается с помощью параметра replace.

Сравните:
example_data = pd.Series([1, 2, 3, 4, 5])
print("Без возвращения")

# Параметр frac определяет процент строк, которые войдут в выборку; 
# при значении "1", все пять строк попадут в выборку в случайном порядке.
print(example_data.sample(frac=1, replace=False, random_state=state))

# При значении параметра replace=True получится выборка тоже из 5 строк,
# но теперь некоторые строки могут повторяться. 
print("С возвращением")
print(example_data.sample(frac=1, replace=True, random_state=state)) 

https://www.notion.so/tbd-2433e028c90f4d65828c0cabccdef895#29586a465b26482299e4d7e8740735f5
https://www.notion.so/tbd-2433e028c90f4d65828c0cabccdef895#61bd80101d3640e4bfae1f15bfced8de